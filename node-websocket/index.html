<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Teste de Websocket</title>
  </head>
  <body>
    <script type="text/javascript">
        window.addEventListener("load", function(){
          username = "user";

          (function(){
            window.messagetoServer = messagetoServer;
            function messagetoServer(string){
              connection.send(string);
            }
          })()

          if(username){
            var connection = new WebSocket("ws://"+window.location.hostname+":8001");

            connection.onopen = function(){
              console.log("Connection established");
            }

            connection.onmessage = function(event){
              console.log(event.data);
            }
            connection.onclose = function () {
        			console.log("Connection closed")
        		}
        		connection.onerror = function () {
        			console.error("Connection error")
        		}
          }
        });
    </script>
  </body>
</html>
